webpackJsonp([1],{LXhF:function(t,e){},NHnr:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=r("7+uW"),a={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]};var s=r("VU/8")({name:"App"},a,!1,function(t){r("LXhF")},null,null).exports,n=r("/ocq"),l=r("mtWM"),i=r.n(l),u=r("mw3O"),m=r.n(u),c=i.a.create({baseURL:"http://127.0.0.1:9002",timeout:65e3,headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:[function(t){return m.a.stringify(t)}]});var d={data:function(){return{form:{userName:"",password:""},rules:{userName:[{required:!0,message:"用户名不能为空",trigger:"blur"},{min:2,max:10,message:"用户名2-10位",trigger:"blur"}],password:[{required:!0,message:"密码不能为空",trigger:"blur"},{min:3,max:10,message:"密码3-10位",trigger:"blur"}]}}},methods:{submitForm:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return e.$message.error("用户名或密码不符合规则请重新输入"),!1;var r,o;(r=e.form.userName,o=e.form.password,c({url:"/logini",method:"post",data:{userName:r,password:o}})).then(function(t){console.log(t.data),"0"===t.data.status?e.$message.error("用户名或密码错误请重新输入"):(console.log("-username",e.form.userName),sessionStorage.username=e.form.userName,sessionStorage.setItem("user",e.form.userName),sessionStorage.setItem("uuid",t.data.uuid),e.$router.push("/main"))}).catch(function(t){e.$message.error("登录超时"),console.error("faild",t)})})}}},p={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"login-container"},[r("el-form",{ref:"form",staticClass:"login-form",attrs:{rules:t.rules,model:t.form,"label-width":"80px"}},[r("h2",{staticClass:"login-title"},[t._v("散桩产家联调测试")]),t._v(" "),r("el-form-item",{attrs:{label:"用户名",prop:"userName"}},[r("el-input",{attrs:{type:"text",placeholder:"请输入账号"},model:{value:t.form.userName,callback:function(e){t.$set(t.form,"userName",e)},expression:"form.userName"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"密码",prop:"password"}},[r("el-input",{attrs:{type:"password",placeholder:"请输入密码"},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1),t._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitForm("form")}}},[t._v("登录")])],1)],1)],1)},staticRenderFns:[]};var f=r("VU/8")(d,p,!1,function(t){r("qnW9")},null,null).exports;var g={created:function(){var t,e=this;(t=sessionStorage.getItem("uuid"),c({url:"/getDeviceList",method:"post",data:{uuid:t}})).then(function(t){t.data.stakes.filter(function(r,o){return e.stakeNoOptions.push({stakeNo:t.data.stakes[o].stakeNo,label:t.data.stakes[o].stakeName}),r>t.data.stakes.length}),e.form.stakeNo=t.data.stakes[0].stakeNo})},data:function(){return{user:sessionStorage.getItem("user"),stakeNoOptions:[],portOptions:[{port:"1",label:"端口1"},{port:"2",label:"端口2"}],loadingStartBtn:!1,loadingStopBtn:!1,stakeStatus:"color:lightgreen;",orderIdp:"",form:{stakeNo:"",port:"1"},rules:{stakeNo:[{required:!0,message:"桩号不能为空",trigger:"blur"},{min:16,max:16,message:"桩号12位",trigger:"blur"}],port:[{required:!0,message:"端口号不能为空",trigger:"blur"},{min:1,max:1,message:"端口1位",trigger:"blur"}]}}},methods:{startElecForm:function(t){var e=this;this.loadingStartBtn=!0,this.$refs[t].validate(function(t){if(!t)return e.loadingStartBtn=!1,e.$message.error("桩号不符合规则请重新输入"),!1;var r,o;(r=e.form.stakeNo,o=e.form.port,c({url:"/startElec",method:"post",data:{stakeNo:r,port:o}})).then(function(t){console.log("下供电:",e.form.stakeNo,", ",e.form.port," ",t.data),"1"===t.data.status&&(e.stakeStatus="color:red;",e.orderIdp=t.data.orderId),e.loadingStartBtn=!1,e.$alert(t.data.msg,"用电结果",{confirmButtonText:"确定"})}).catch(function(t){e.loadingStartBtn=!1,console.error("faild",t)})})},stopElecForm:function(){var t,e,r=this;this.loadingStopBtn=!0,(t=this.form.stakeNo,e=this.form.port,c({url:"/getOrderId",method:"post",data:{stakeNo:t,port:e}})).then(function(t){if(console.log("下断电:",t.data),""===t.data.orderId)return r.loadingStopBtn=!1,void r.$alert("未找到供电中的订单","停止用电结果",{confirmButtonText:"确定"});var e;(e=t.data.orderId,c({url:"/stopElec",method:"post",data:{orderId:e}})).then(function(t){r.loadingStopBtn=!1,console.log("1111",t.data),"1"===t.data.status?(r.stakeStatus="color:lightgreen",r.$alert("停止用电成功","停止用电结果",{confirmButtonText:"确定"})):r.$alert(t.data.msg,"停止用电结果",{confirmButtonText:"确定"})}).catch(function(t){r.loadingStopBtn=!1,console.error("faild",t)})}).catch(function(t){r.loadingStopBtn=!1,r.$alert("超时","停止用电结果",{confirmButtonText:"确定"})})},logout:function(){this.$router.push("/login"),sessionStorage.clear()}}},h={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"main"},[r("dir",{staticClass:"header"},[r("el-row",[r("el-col",{attrs:{span:22}},[r("p",[t._v("用户: "+t._s(t.user))])]),t._v(" "),r("el-col",{attrs:{span:2}},[r("el-button",{staticClass:"logout-button",attrs:{type:"primary"},on:{click:function(e){return t.logout()}}},[t._v("退出登录")])],1)],1)],1),t._v(" "),r("div",{staticClass:"body"},[r("el-row",{staticClass:"order"},[r("el-col",{attrs:{span:24}},[r("p",[t._v("订单号: "+t._s(t.orderIdp))])])],1),t._v(" "),r("el-form",{ref:"start-form",staticClass:"start-elec-form",attrs:{rules:t.rules,model:t.form,"label-width":"80px",span:15}},[r("el-form-item",{attrs:{label:"桩号:",prop:"stakeNo"}},[r("el-select",{attrs:{placeholder:"请选择"},model:{value:t.form.stakeNo,callback:function(e){t.$set(t.form,"stakeNo",e)},expression:"form.stakeNo"}},t._l(t.stakeNoOptions,function(t){return r("el-option",{key:t.stakeNo,attrs:{label:t.label,value:t.stakeNo}})}),1)],1),t._v(" "),r("el-form-item",{attrs:{label:"端口号:",prop:"port"}},[r("el-select",{attrs:{placeholder:"请选择"},model:{value:t.form.port,callback:function(e){t.$set(t.form,"port",e)},expression:"form.port"}},t._l(t.portOptions,function(t){return r("el-option",{key:t.port,attrs:{label:t.label,value:t.port}})}),1)],1),t._v(" "),r("el-form-item",[r("el-button",{staticClass:"start-button",attrs:{type:"success",loading:t.loadingStartBtn},on:{click:function(e){return t.startElecForm("start-form")}}},[t._v("申请用电")]),t._v(" "),r("el-button",{staticClass:"stop-button",attrs:{type:"danger",loading:t.loadingStopBtn},on:{click:function(e){return t.stopElecForm()}}},[t._v("停止用电")])],1)],1)],1)],1)},staticRenderFns:[]};var v=r("VU/8")(g,h,!1,function(t){r("wTfg")},null,null).exports,k=(r("tvR6"),r("zL8q")),b=r.n(k);o.default.use(n.a),o.default.use(b.a);var N=new n.a({routes:[{path:"/login",name:"login",component:f},{path:"/",name:"index",component:f},{path:"/main",name:"main",component:v}],mode:"history"}),_=N;N.beforeEach(function(t,e,r){"/login"===t.path?r():sessionStorage.username?r():r({path:"/login"})}),o.default.config.productionTip=!1,new o.default({el:"#app",router:_,components:{App:s},template:"<App/>"})},qnW9:function(t,e){},tvR6:function(t,e){},wTfg:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.1d02eb27e78ed808a0a6.js.map