webpackJsonp([1],{FjDt:function(t,e){},JBre:function(t,e){},LXhF:function(t,e){},NHnr:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("7+uW"),l={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]};var o=a("VU/8")({name:"App"},l,!1,function(t){a("LXhF")},null,null).exports,s=a("/ocq"),n=a("mtWM"),i=a.n(n),c=a("mw3O"),_=a.n(c),d=i.a.create({baseURL:"http://127.0.0.1:9002",timeout:65e3,headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:[function(t){return _.a.stringify(t)}]});var u={data:function(){return{form:{userName:"",password:""},rules:{userName:[{required:!0,message:"用户名不能为空",trigger:"blur"},{min:2,max:10,message:"用户名2-10位",trigger:"blur"}],password:[{required:!0,message:"密码不能为空",trigger:"blur"},{min:3,max:10,message:"密码3-10位",trigger:"blur"}]}}},methods:{submitForm:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return e.$message.error("用户名或密码不符合规则请重新输入"),!1;var a,r;(a=e.form.userName,r=e.form.password,d({url:"/logini",method:"post",data:{userName:a,password:r}})).then(function(t){console.log(t.data),"0"===t.data.status?e.$message.error("用户名或密码错误请重新输入"):(console.log("-username",e.form.userName),sessionStorage.username=e.form.userName,sessionStorage.setItem("user",e.form.userName),sessionStorage.setItem("uuid",t.data.uuid),e.$router.push("/main"))}).catch(function(t){e.$message.error("登录超时"),console.error("faild",t)})})}}},v={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"login-container"},[a("el-form",{ref:"form",staticClass:"login-form",attrs:{rules:t.rules,model:t.form,"label-width":"80px"}},[a("h2",{staticClass:"login-title"},[t._v("散桩厂家联调测试")]),t._v(" "),a("el-form-item",{attrs:{label:"用户名",prop:"userName"}},[a("el-input",{attrs:{type:"text",placeholder:"请输入账号"},model:{value:t.form.userName,callback:function(e){t.$set(t.form,"userName",e)},expression:"form.userName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{attrs:{type:"password",placeholder:"请输入密码"},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitForm("form")}}},[t._v("登录")])],1)],1)],1)},staticRenderFns:[]};var m=a("VU/8")(u,v,!1,function(t){a("FjDt")},null,null).exports;function g(t,e){return d({url:"/getOrderId",method:"post",data:{stakeNo:t,port:e}})}function p(t,e){return d({url:"/getWorkState",method:"post",data:{stakeNo:t,port:e}})}var f={created:function(){var t,e=this;(t=sessionStorage.getItem("uuid"),d({url:"/getDeviceList",method:"post",data:{uuid:t}})).then(function(t){t.data.stakes.filter(function(a,r){return e.stakeNoOptions.push({stakeNo:t.data.stakes[r].stakeNo,label:t.data.stakes[r].stakeName}),a>t.data.stakes.length}),e.form.stakeNo=t.data.stakes[0].stakeNo,g(e.form.stakeNo,e.form.port).then(function(t){e.orderIdp=t.data.orderId}),p(e.form.stakeNo,e.form.port).then(function(t){"3"===t.data.workState?e.orderColor="color:red;":"1"===t.data.workState?e.orderColor="color:orange;":e.orderColor="color:green;",console.log(t.data.workState)})})},data:function(){return{user:sessionStorage.getItem("user"),stakeNoOptions:[],portOptions:[{port:"1",label:"端口1"},{port:"2",label:"端口2"}],elec_time:"",total_elec:"",sport_elec:"",peak_elec:"",flat_elec:"",valley_elec:"",meter_time:"",ua:"",ub:"",uc:"",ia:"",ib:"",ic:"",pp:"",signalstyle:"color:#2db0c5;font-size: 20px;",time:"",work_state:"",switch_state:"",relay_state:"",ov_warn:"",uv_warn:"",lp_warn:"",spd_error:"",scram_error:"",leakage_elec:"",meter_error:"",access_error:"",oc_error:"",water_error:"",dump_error:"",loadingStartBtn:!1,loadingStopBtn:!1,getSignalBtn:!1,getMeterBtn:!1,getElecBtn:!1,orderColor:"color:black;",orderIdp:"",form:{stakeNo:"",port:"1"},rules:{stakeNo:[{required:!0,message:"桩号不能为空",trigger:"blur"},{min:16,max:16,message:"桩号12位",trigger:"blur"}],port:[{required:!0,message:"端口号不能为空",trigger:"blur"},{min:1,max:1,message:"端口1位",trigger:"blur"}]}}},methods:{startElecForm:function(t){var e=this;this.loadingStartBtn=!0,this.$refs[t].validate(function(t){if(!t)return e.loadingStartBtn=!1,e.$message.error("桩号不符合规则请重新输入"),!1;var a,r;(a=e.form.stakeNo,r=e.form.port,d({url:"/startElec",method:"post",data:{stakeNo:a,port:r}})).then(function(t){console.log("下供电:",e.form.stakeNo,", ",e.form.port," ",t.data),"1"===t.data.status&&(e.orderColor="color:red;",e.orderIdp=t.data.orderId),e.loadingStartBtn=!1,e.$alert(t.data.msg,"用电结果",{confirmButtonText:"确定"})}).catch(function(t){e.loadingStartBtn=!1,console.error("faild",t)})})},stopElecForm:function(){var t=this;this.loadingStopBtn=!0,g(this.form.stakeNo,this.form.port).then(function(e){if(console.log("下断电:",e.data),""===e.data.orderId)return t.loadingStopBtn=!1,void t.$alert("未找到供电中的订单","停止用电结果",{confirmButtonText:"确定"});var a;(a=e.data.orderId,d({url:"/stopElec",method:"post",data:{orderId:a}})).then(function(e){t.loadingStopBtn=!1,console.log("1111",e.data),"1"===e.data.status?(t.orderColor="color:green;",t.$alert("停止用电成功","停止用电结果",{confirmButtonText:"确定"})):t.$alert(e.data.msg,"停止用电结果",{confirmButtonText:"确定"})}).catch(function(e){t.loadingStopBtn=!1,console.error("faild",e)})}).catch(function(e){t.loadingStopBtn=!1,t.$alert("超时","停止用电结果",{confirmButtonText:"确定"})})},logout:function(){this.$router.push("/login"),sessionStorage.clear()},getDeviceMsg:function(){var t=this;g(this.form.stakeNo,this.form.port).then(function(e){t.orderIdp=e.data.orderId}),p(this.form.stakeNo,this.form.port).then(function(e){"3"===e.data.workState?t.orderColor="color:red;":"1"===e.data.workState?t.orderColor="color:orange;":t.orderColor="color:green;",console.log(e.data.workState)}),console.log(this.form.stakeNo,this.form.port)},getSignal:function(){var t,e,a=this;this.getSignalBtn=!0,(t=this.form.stakeNo,e=this.form.port,d({url:"/getSignal",method:"post",data:{stakeNo:t,port:e}})).then(function(t){a.getSignalBtn=!1;var e=t.data.time.substring(0,4)+"-"+t.data.time.substring(4,6)+"-"+t.data.time.substring(6,8),r=t.data.time.substring(8,10)+":"+t.data.time.substring(10,12)+":"+t.data.time.substring(12,14);a.time=e+" "+r,a.work_state=t.data.workstate,a.switch_state=t.data.switchstate,a.relay_state=t.data.relaystate,a.ov_warn=t.data.ovwarn,a.uv_warn=t.data.uvwarn,a.lp_warn=t.data.lpwarn,a.spd_error=t.data.spderror,a.scram_error=t.data.scramerror,a.leakage_elec=t.data.leakageelec,a.meter_error=t.data.metererror,a.access_error=t.data.accesserror,a.oc_error=t.data.ocerror,a.water_error=t.data.watererror,a.dump_error=t.data.dumperror,console.log(t.data)}).catch(function(){a.getSignalBtn=!1})},getMeter:function(){var t,e,a=this;this.getMeterBtn=!0,(t=this.form.stakeNo,e=this.form.port,d({url:"/getMeter",method:"post",data:{stakeNo:t,port:e}})).then(function(t){a.getMeterBtn=!1;var e=t.data.time.substring(0,4)+"-"+t.data.time.substring(4,6)+"-"+t.data.time.substring(6,8),r=t.data.time.substring(8,10)+":"+t.data.time.substring(10,12)+":"+t.data.time.substring(12,14);a.meter_time=e+" "+r,a.ua=t.data.ua,a.ub=t.data.ub,a.uc=t.data.uc,a.ia=t.data.ia,a.ib=t.data.ib,a.ic=t.data.ic,a.pp=t.data.pp,console.log(t.data)}).catch(function(){a.getMeterBtn=!1})},getElec:function(){var t,e,a=this;this.getElecBtn=!0,(t=this.form.stakeNo,e=this.form.port,d({url:"/getElec",method:"post",data:{stakeNo:t,port:e}})).then(function(t){a.getElecBtn=!1;var e=t.data.time.substring(0,4)+"-"+t.data.time.substring(4,6)+"-"+t.data.time.substring(6,8),r=t.data.time.substring(8,10)+":"+t.data.time.substring(10,12)+":"+t.data.time.substring(12,14);a.elec_time=e+" "+r,a.total_elec=t.data.totalelec,a.sport_elec=t.data.sportelec,a.peak_elec=t.data.peakelec,a.flat_elec=t.data.flatelec,a.valley_elec=t.data.valleyelec,console.log(t.data)}).catch(function(){a.getElecBtn=!1})}}},b={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"main"},[a("el-row",[a("el-col",{attrs:{span:22}},[a("p",[t._v("用户: "+t._s(t.user))])]),t._v(" "),a("el-col",{attrs:{span:2}},[a("el-button",{staticClass:"logout-button",attrs:{type:"primary"},on:{click:function(e){return t.logout()}}},[t._v("退出登录")])],1)],1),t._v(" "),a("hr"),t._v(" "),a("div",{staticClass:"elec-form"},[a("el-row",{staticClass:"order"},[a("el-col",{attrs:{span:24}},[a("p",{style:t.orderColor},[t._v("订单号: "+t._s(t.orderIdp))])])],1),t._v(" "),a("el-form",{ref:"start-form",attrs:{rules:t.rules,model:t.form,"label-width":"80px",span:15}},[a("el-form-item",{attrs:{label:"桩号:",prop:"stakeNo"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:t.getDeviceMsg},model:{value:t.form.stakeNo,callback:function(e){t.$set(t.form,"stakeNo",e)},expression:"form.stakeNo"}},t._l(t.stakeNoOptions,function(t){return a("el-option",{key:t.stakeNo,attrs:{label:t.label,value:t.stakeNo}})}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"端口号:",prop:"port"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:t.getDeviceMsg},model:{value:t.form.port,callback:function(e){t.$set(t.form,"port",e)},expression:"form.port"}},t._l(t.portOptions,function(t){return a("el-option",{key:t.port,attrs:{label:t.label,value:t.port}})}),1)],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"success",loading:t.loadingStartBtn},on:{click:function(e){return t.startElecForm("start-form")}}},[t._v("申请用电")]),t._v(" "),a("el-button",{attrs:{type:"danger",loading:t.loadingStopBtn},on:{click:function(e){return t.stopElecForm()}}},[t._v("停止用电")])],1),t._v(" "),a("el-form-item",[a("el-button",{staticStyle:{"text-align":"center"},attrs:{type:"info",loading:t.getSignalBtn,plain:""},on:{click:t.getSignal}},[t._v("获取设备遥信")]),t._v(" "),a("el-button",{staticStyle:{"text-align":"center"},attrs:{type:"info",loading:t.getMeterBtn,plain:""},on:{click:t.getMeter}},[t._v("获取设备遥测")]),t._v(" "),a("el-button",{staticStyle:{"text-align":"center"},attrs:{type:"info",loading:t.getElecBtn,plain:""},on:{click:t.getElec}},[t._v("获取设备计量")])],1)],1)],1),t._v(" "),a("hr"),t._v(" "),a("div",{staticClass:"singal-div"},[a("label",{staticStyle:{color:"red"}},[t._v('\n      "解析数据说明 - "\n    ')]),t._v(" "),a("em",{staticStyle:{color:"#2db0c5","font-size":"20px"}},[t._v("遥信")]),t._v(" "),a("ul",[a("el-col",{attrs:{span:12}},[a("li",[a("label",[t._v("采集时间 : ")]),t._v(" "),a("label",{style:t.signalstyle},[t._v(t._s(t.time))])]),t._v(" "),a("li",[a("label",[t._v("工作状态 : ")]),t._v(" "),a("label",{style:t.signalstyle},[t._v(t._s(t.work_state))])]),t._v(" "),a("li",[a("label",[t._v("连接确认开关状态 : ")]),t._v(" "),a("label",{style:t.signalstyle},[t._v(t._s(t.switch_state))])]),t._v(" "),a("li",[a("label",[t._v("输出继电器状态 : ")]),t._v(" "),a("label",{style:t.signalstyle},[t._v(t._s(t.relay_state))])]),t._v(" "),a("li",[a("label",[t._v("交流输出过压告警 : ")]),t._v(" "),a("label",{style:t.signalstyle},[t._v(t._s(t.ov_warn))])]),t._v(" "),a("li",[a("label",[t._v("交流输出欠压告警 : ")]),t._v(" "),a("label",{style:t.signalstyle},[t._v(t._s(t.uv_warn))])]),t._v(" "),a("li",[a("label",[t._v("交流输出缺相告警 : ")]),t._v(" "),a("label",{style:t.signalstyle},[t._v(t._s(t.lp_warn))])]),t._v(" "),a("li",[a("label",[t._v("防雷器故障 : ")]),t._v(" "),a("label",{style:t.signalstyle},[t._v(t._s(t.spd_error))])])]),t._v(" "),a("li",[a("label",[t._v("急停故障 : ")]),t._v(" "),a("label",{style:t.signalstyle},[t._v(t._s(t.scram_error))])]),t._v(" "),a("li",[a("label",[t._v("漏电保护 : ")]),t._v(" "),a("label",{style:t.signalstyle},[t._v(t._s(t.leakage_elec))])]),t._v(" "),a("li",[a("label",[t._v("电表通讯故障 : ")]),t._v(" "),a("label",{style:t.signalstyle},[t._v(t._s(t.meter_error))])]),t._v(" "),a("li",[a("label",[t._v("门禁故障 : ")]),t._v(" "),a("label",{style:t.signalstyle},[t._v(t._s(t.access_error))])]),t._v(" "),a("li",[a("label",[t._v("过流故障 : ")]),t._v(" "),a("label",{style:t.signalstyle},[t._v(t._s(t.oc_error))])]),t._v(" "),a("li",[a("label",[t._v("水浸故障 : ")]),t._v(" "),a("label",{style:t.signalstyle},[t._v(t._s(t.water_error))])]),t._v(" "),a("li",[a("label",[t._v("倾倒故障 : ")]),t._v(" "),a("label",{style:t.signalstyle},[t._v(t._s(t.dump_error))])])],1)]),t._v(" "),a("br"),t._v(" "),a("hr"),t._v(" "),a("el-col",{attrs:{span:12}},[a("div",{staticClass:"meter-div"},[a("label",{staticStyle:{color:"red"}},[t._v('\n      "解析数据说明 - "\n      '),a("em",{staticStyle:{color:"#2db0c5","font-size":"20px"}},[t._v("遥测")])]),t._v(" "),a("ul",[a("li",[a("label",[t._v("采集时间 : ")]),t._v(" "),a("label",{style:t.signalstyle},[t._v(t._s(t.meter_time))])]),t._v(" "),a("li",[a("label",[t._v("A相电压 : ")]),t._v(" "),a("label",{style:t.signalstyle},[t._v(t._s(t.ua))])]),t._v(" "),a("li",[a("label",[t._v("B相电压 : ")]),t._v(" "),a("label",{style:t.signalstyle},[t._v(t._s(t.ub))])]),t._v(" "),a("li",[a("label",[t._v("C相电压 : ")]),t._v(" "),a("label",{style:t.signalstyle},[t._v(t._s(t.uc))])]),t._v(" "),a("li",[a("label",[t._v("A相电流 : ")]),t._v(" "),a("label",{style:t.signalstyle},[t._v(t._s(t.ia))])]),t._v(" "),a("li",[a("label",[t._v("B相电流 : ")]),t._v(" "),a("label",{style:t.signalstyle},[t._v(t._s(t.ib))])]),t._v(" "),a("li",[a("label",[t._v("C相电流 : ")]),t._v(" "),a("label",{style:t.signalstyle},[t._v(t._s(t.ic))])]),t._v(" "),a("li",[a("label",[t._v("功率 : ")]),t._v(" "),a("label",{style:t.signalstyle},[t._v(t._s(t.pp))])])])])]),t._v(" "),a("el-col",{attrs:{span:12}},[a("div",{staticClass:"meter-div"},[a("label",{staticStyle:{color:"red"}},[t._v('\n        "解析数据说明 - "\n        '),a("em",{staticStyle:{color:"#2db0c5","font-size":"20px"}},[t._v("计量")])]),t._v(" "),a("ul",[a("li",[a("label",[t._v("采集时间 : ")]),t._v(" "),a("label",{style:t.signalstyle},[t._v(t._s(t.elec_time))])]),t._v(" "),a("li",[a("label",[t._v("总电量 : ")]),t._v(" "),a("label",{style:t.signalstyle},[t._v(t._s(t.total_elec))])]),t._v(" "),a("li",[a("label",[t._v("尖电量 : ")]),t._v(" "),a("label",{style:t.signalstyle},[t._v(t._s(t.sport_elec))])]),t._v(" "),a("li",[a("label",[t._v("峰电量 : ")]),t._v(" "),a("label",{style:t.signalstyle},[t._v(t._s(t.peak_elec))])]),t._v(" "),a("li",[a("label",[t._v("平电量 : ")]),t._v(" "),a("label",{style:t.signalstyle},[t._v(t._s(t.flat_elec))])]),t._v(" "),a("li",[a("label",[t._v("谷电量 : ")]),t._v(" "),a("label",{style:t.signalstyle},[t._v(t._s(t.valley_elec))])])])])])],1)},staticRenderFns:[]};var h=a("VU/8")(f,b,!1,function(t){a("JBre")},null,null).exports,y=(a("tvR6"),a("zL8q")),k=a.n(y);r.default.use(s.a),r.default.use(k.a);var w=new s.a({routes:[{path:"/login",name:"login",component:m},{path:"/",name:"index",component:m},{path:"/main",name:"main",component:h}],mode:"history"}),N=w;w.beforeEach(function(t,e,a){"/login"===t.path?a():sessionStorage.username?a():a({path:"/login"})}),r.default.config.productionTip=!1,new r.default({el:"#app",router:N,components:{App:o},template:"<App/>"})},tvR6:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.2f4913830426924cb3d9.js.map